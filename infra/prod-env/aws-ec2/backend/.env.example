# Java 後端開發環境配置
#
# 重要：這些環境變數只用於基礎設施連接
# Spring Boot 應用層配置請在後端專案的 application.yml 中定義
#
# 使用說明：複製此檔案為 .env 並填入實際值

# 資料庫配置
DB_URL=jdbc:mysql://[DB_HOST]:3306/[DATABASE_NAME]?useUnicode=true&characterEncoding=UTF-8&serverTimezone=Asia/Taipei&useSSL=false&allowPublicKeyRetrieval=true
DB_USERNAME=[DB_USERNAME]
DB_PASSWORD=[DB_PASSWORD]

# JWT 配置
# 生成指令: openssl rand -base64 64
JWT_SECRET=[JWT_SECRET]
# Access Token 有效期 (毫秒) - 會員 15 分鐘 = 900000, 管理員 30 分鐘 = 1800000
JWT_MEMBER_ACCESS_EXPIRATION=900000
JWT_ADMIN_ACCESS_EXPIRATION=1800000
# Refresh Token 有效期 (毫秒) - 7 天 = 604800000
JWT_REFRESH_EXPIRATION=604800000

# ====================
# 郵件服務配置
# ====================
# 郵件服務提供者: smtp (開發環境/Mailpit) | resend (生產環境推薦) | aws-ses (已廢棄)
EMAIL_PROVIDER=resend

# 發信地址配置 (所有提供者共用)
MAIL_FROM_ADDRESS=noreply@example.com
MAIL_FROM_NAME=[APP_NAME]

# 開發環境: SMTP 配置 (使用 Mailpit 本地測試)
# MAIL_HOST=mailpit
# MAIL_PORT=1025
# MAIL_USERNAME=noreply@example.com
# MAIL_PASSWORD=
# MAIL_SMTP_AUTH=false
# MAIL_SMTP_STARTTLS=false

# 生產環境: Resend 配置 (推薦)
# 取得 API Key: https://resend.com/api-keys
RESEND_API_KEY=[RESEND_API_KEY]

# 註: AWS SES 配置 (當 EMAIL_PROVIDER=aws-ses 時使用,已廢棄)
# AWS_REGION=ap-south-1 (已在下方 AWS S3 配置中定義)
# AWS_ACCESS_KEY_ID=[AWS_ACCESS_KEY_ID] (已在下方 AWS S3 配置中定義)
# AWS_SECRET_ACCESS_KEY=[AWS_SECRET_ACCESS_KEY] (已在下方 AWS S3 配置中定義)

# 應用程式配置
APP_BASE_URL=http://localhost:8083

# 測試端點配置 (僅開發/測試環境啟用,生產環境設為 false)
APP_TEST_ENDPOINTS_ENABLED=false

# 日誌配置 (可選值: TRACE, DEBUG, INFO, WARN, ERROR)
# 生產環境建議: LOG_LEVEL_ROOT=INFO, LOG_LEVEL_APP=INFO, LOG_LEVEL_SQL=WARN
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=INFO
LOG_LEVEL_WEB=INFO
LOG_LEVEL_SQL=WARN
LOG_LEVEL_SQL_BINDER=WARN

# 日誌檔案配置
LOG_PATH=/app/logs
LOG_FILE=mimimart-prod
SPRING_PROFILES_ACTIVE=prod

# JPA 配置 (生產環境建議設為 false)
JPA_SHOW_SQL=false

# Mailpit API 配置 (可選 - 僅開發環境使用)
# MAILPIT_API_URL=http://mailpit:8025/api/v1

# AWS S3 配置
AWS_REGION=ap-south-1
AWS_ACCESS_KEY_ID=[AWS_ACCESS_KEY_ID]
AWS_SECRET_ACCESS_KEY=[AWS_SECRET_ACCESS_KEY]
# 私有 Bucket (會員頭貼等敏感資料)
S3_BUCKET_NAME=[S3_PRIVATE_BUCKET]
# 公開 Bucket (輪播圖、商品圖片等公開資源)
S3_PUBLIC_BUCKET_NAME=[S3_PUBLIC_BUCKET]
# 公開 Bucket 的基礎 URL (自訂域名)
S3_PUBLIC_BASE_URL=http://cdn.example.com

# ECPay 綠界金流配置
# 測試環境特店編號
ECPAY_MERCHANT_ID=2000132
# 測試環境 HashKey (測試環境預設值)
ECPAY_HASH_KEY=pwFHCqoQZGmho4w6
# 測試環境 HashIV (測試環境預設值)
ECPAY_HASH_IV=EkRm7iFT261dpevs
# API 網址 (測試環境)
ECPAY_API_URL=https://payment-stage.ecpay.com.tw

# 使用者付款完成後返回的頁面 (含 5 秒倒數自動跳轉到前端)
# 本地開發: 可使用 Cloudflare Tunnel 或保持 localhost
# 範例: cloudflared tunnel --url http://localhost:8080
# 使用時請將 app1.example.com 替換為實際的 Cloudflare Tunnel 域名
ECPAY_RETURN_URL=http://app1.example.com/api/v1/payment/callback/return

# 伺服器端接收付款結果通知的 URL (必須是公開可訪問的 URL)
# 本地開發: 必須使用 Cloudflare Tunnel 或 ngrok 提供的公開 URL
# 範例: cloudflared tunnel --url http://localhost:8080
# 使用時請將 app1.example.com 替換為實際的 Cloudflare Tunnel 域名
ECPAY_CALLBACK_URL=http://app1.example.com/api/v1/payment/callback/notify

# 前端應用 URL (用於付款完成後跳轉)
# 本地開發: http://localhost:5173
# 生產環境: https://example.com
APP_FRONTEND_URL=https://example.com

# Redis 配置
REDIS_HOST=[REDIS_HOST]
REDIS_PORT=6379
REDIS_PASSWORD=[REDIS_PASSWORD]
REDIS_DATABASE=0

# 郵件配額配置
# 每月發送上限 (根據 Resend 方案調整)
EMAIL_MONTHLY_LIMIT=1000
# 告警閾值百分比 (當達到 80%, 90%, 100% 時發送告警)
EMAIL_ALERT_THRESHOLDS=80,90,100
# 郵箱驗證碼限制 (10 分鐘內最多 3 次)
EMAIL_VERIFICATION_MAX_ATTEMPTS=3
EMAIL_VERIFICATION_WINDOW_MINUTES=10
# 密碼重置限制 (60 分鐘內最多 3 次)
EMAIL_PASSWORD_RESET_MAX_ATTEMPTS=3
EMAIL_PASSWORD_RESET_WINDOW_MINUTES=60


# ====================
# AI 服務配置
# ====================
# OpenAI 配置 (DALL-E 圖片生成)
# 1. 註冊 OpenAI: https://platform.openai.com
# 2. 取得 API Key: https://platform.openai.com/api-keys
OPENAI_API_KEY=[YOUR_OPENAI_API_KEY]
OPENAI_API_URL=https://api.openai.com/v1
OPENAI_MODEL=dall-e-2
OPENAI_IMAGE_SIZE=1024x1024
OPENAI_IMAGE_QUALITY=standard

# Deepseek 配置 (文字生成)
# 1. 註冊 Deepseek: https://platform.deepseek.com
# 2. 取得 API Key: https://platform.deepseek.com/api_keys
DEEPSEEK_API_KEY=[YOUR_DEEPSEEK_API_KEY]
DEEPSEEK_API_URL=https://api.deepseek.com/v1
DEEPSEEK_MODEL=deepseek-chat
